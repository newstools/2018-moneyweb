Microsoft said it reached an agreement to buy GitHub, the code repository company popular with many software developers, for $7.5 billion in stock. The deal will add to Microsoft’s operating income, including some costs, in its fiscal year 2020, the company said in a statement Monday. Microsoft expects the deal to close by the end of 2018. The shares were up less than 1% to $101.32 at 9:32 am in New York. The acquisition provides a way forward for San Francisco-based GitHub, which has been trying for nine months to find a new chief executive officer and has yet to make a profit from its popular service that allows coders to share and collaborate on their work. It also helps Microsoft, which is increasingly relying on open-source software, to add programming tools and tie up with a company that has become a key part of the way Microsoft writes its own software. GitHub will operate independently and named former Xamarin CEO and current Microsoft developer tools executive Nat Friedman as it’s chief. It will continue to support the programming languages, tools and operating systems of the user’s choice. For Microsoft, acquiring GitHub is both a return to the company’s earliest roots and a sharp turnaround from where it was a decade ago. Microsoft’s origin story lies in the market for software-development tools, with co-founders Bill Gates and Paul Allen focused on giving hobbyists a way to program a new micro-computer kit. But that vision of software tools was applied very differently under both Gates and former Chief Executive Officer Steve Ballmer, who championed developers building proprietary software for Microsoft, not the kind of open-source projects found on GitHub. In fact, in the early 2000s, Ballmer and his team were highly critical of that kind of a project, calling it a “cancer” and saying that it went against “the American Way.” Open-source software allows developers to tinker with, improve upon and share code — an approach that threatened Microsoft’s business model. A lot has changed since then, and under current CEO Satya Nadella, Microsoft is supporting many flavours of Linux and has used open-source models on some significant cloud and developer products itself. This deal will mark another dramatic step in that direction. “Microsoft is a developer-first company, and by joining forces with GitHub we strengthen our commitment to developer freedom, openness and innovation,” Nadella said in the statement. Redmond, Washington-based Microsoft is now one of the biggest contributors to GitHub, and as Nadella moves the company away from complete dependence on the Windows operating system to more in-house development on Linux, the company needs new ways to connect with the broader developer community. GitHub preferred selling the company to going public and chose Microsoft partially because it was impressed by Nadella, a person familiar with the deal said on Sunday. San Francisco-based GitHub is an essential tool for coders. Many corporations, including Microsoft and Alphabet Inc.’s Google, use it to store their corporate code and to collaborate. It’s also a social network of sorts for developers. Still, GitHub’s losses have been significant — it lost $66 million over three quarters in 2016. The company had revenue of $98 million in nine months of 2016. In August, GitHub announced that it was looking for a CEO to replace Chris Wanstrath, one of the co-founders. In the interim, GitHub’s Chief Business Officer Julio Avalos joined the company’s board of directors and took over much of the day-to-day leadership of the company. Microsoft has talked to GitHub, which hosts more than 28 million software developers working on 80 million repositories of code, on and off for a few years. Recently they began talks about a partnership but progressed to discussing an acquisition, according to another person familiar with the situation. GitHub was last valued at $2 billion in 2015, making today’s deal a win for GitHub backers like Sequoia Capital and Andreessen Horowitz.